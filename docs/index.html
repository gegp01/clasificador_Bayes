 <!DOCTYPE html>
<html>
<head>
 <title>C3 symbiontIT</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width">
    <link rel="stylesheet" type="text/css" href="css/spacelab/bootstrap.min.css">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
 </head>
 
<body>
  
  <div>
  <h3>Compilador de datos para el análisis de COVID-19 en México</h3>
  
  <h4>1. Para cosechar los datos del reporte de diario de la Dirección general de Epidemiología se puede utilizar la siguiente instrucción:<h4>

  <div class="card text-white bg-dark mb-3" style="max-width: 20rem;">
    <div class="card-header">Datos de la Dirección General de Epidemiología</div>
    <div class="card-body">
      <h4 class="card-title">source("datos_DGE.R")</h4>
      <p class="card-text">El código cosecha la información oficial, guarda una copia y la almacena en un directorio local. El documento <i>datos_DGE.R</i> tiene las siguientes instrucciones, que se ejecutan al leer el archivo desde la dirección url. 
      </p>
    </div>
  </div>

<div class="card-body">
    "# CREAR UN DIRECTORIO TEMPORAL
      td = tempdir()

    # create the placeholder file
    # GENERAR UN ARCHIVO TEMPORAL
      tf = tempfile(tmpdir=td, fileext=".zip")

    # DESCARGAR LOS DATOS DEL URL EN EL ARCHIVO TEMPORAL
      download.file("http://datosabiertos.salud.gob.mx/gobmx/salud/datos_abiertos/datos_abiertos_covid19.zip", tf)

    # LEER EL NOMBRE DEL PRIMER DOCUMENTO EN EL ARCHIVO ZIP.
      fname = unzip(tf, list=TRUE)$Name[1]

    # EXTRAER EL DOCUMENTO Y GUARDARLO EN EL DIRECTORIO TEMPORAL
      unzip(tf, files=fname, exdir=td, overwrite=TRUE)

    # OBTENER LA RUTA AL DOCUMENTO (fpath)
      fpath = file.path(td, fname)

    # LEER LAS PRIMERAS FILAS DEL DOCUMENTO EN fpath PARA SABER SUS DIMENSIONES (filas, coumnas) 
      d = read.csv(fpath, header=TRUE, row.names=NULL, stringsAsFactors=FALSE, nrows=10) 
      q<-ncol(d) # NUMERO DE COLUMNAS EN EL DOCUMENTO

    # LEER TODO EL DOCUMENTO, ASIGNANDO LA CLASE CARACTER PARA TODAS LAS COLUMNAS. ESTO PERMITE MANTENER LA INTEGRIDAD DEL CODIGO DE MUNICIPIO (MUCIPIO_OFICIA)
      covid = read.csv(fpath, header=TRUE, row.names=NULL, stringsAsFactors=FALSE, colClasses=c(rep("character",q))) 

      print("LISTO! LOS DATOS ESTÁN EN EL DATAFRAME covid")"
    
   </div>

</body>
</html>
